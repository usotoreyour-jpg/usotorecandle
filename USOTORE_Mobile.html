<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>USOTORE Mobile ― ローソク足版</title>

<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0a0a0a;--panel:#0f0f10;--text:#f3f4f6;
  --win:#22c55e;--lose:#ef4444;--gold:#fbbf24;--cyan:#38bdf8;
}
*{box-sizing:border-box}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:"Rajdhani","Noto Sans JP",system-ui,sans-serif;
  overflow:hidden;height:100vh;display:flex;flex-direction:column;
}
#chart{flex:1;width:100%;background:#0b0b10}
#title{
  position:absolute;top:10px;left:50%;transform:translateX(-50%);
  font-size:22px;letter-spacing:4px;font-weight:700;
  color:rgba(251,191,36,0.8);text-shadow:0 0 15px rgba(251,191,36,0.3);
  pointer-events:none;z-index:100;
}
.hud{
  background:rgba(0,0,0,.65);padding:10px 12px;border-top:1px solid #374151;
  backdrop-filter:blur(6px);width:100%;font-size:14px;
}
.row{display:flex;gap:8px;align-items:center;margin-top:8px}
.row label{min-width:90px;font-size:12px;color:#cbd5e1}
.row input,.row select{flex:1;padding:8px;border-radius:8px;border:1px solid #334155;background:#0e0e12;color:#fff;font-size:14px}
.btn{flex:1;padding:12px;border:none;border-radius:10px;font-weight:800;cursor:pointer;color:#111;font-size:16px}
.btnH{background:linear-gradient(90deg,#16a34a,#22c55e)}
.btnL{background:linear-gradient(90deg,#ef4444,#f43f5e)}
.hl{display:flex;gap:8px;margin-top:10px}
.pill{
  position:absolute;top:10px;right:12px;background:rgba(0,0,0,.6);
  border:1px solid #374151;padding:6px 10px;border-radius:10px;font-size:13px
}
</style>
</head>

<body>
<div id="title">ＵＳＯＴＯＲＥ</div>
<div id="chart"></div>

<div class="hud">
  <div class="row">
    <label>判定時間</label>
    <select id="expirySelect">
      <option value="0.5">30秒</option>
      <option value="1">1分</option>
      <option value="5">5分</option>
      <option value="10">10分</option>
      <option value="20">20分</option>
      <option value="custom">任意（分）</option>
    </select>
  </div>

  <div class="row" id="customRow" style="display:none;">
    <label>任意分数</label>
    <input id="expiryCustomMin" type="number" value="3" min="0.5" max="240" step="0.5">
  </div>

  <div class="row"><label>賭け金</label><input id="stake" type="number" value="1000" min="100" step="100"></div>
  <div class="row"><label>ペイアウト</label><input id="payout" type="number" value="1.8" step="0.05"></div>

  <div class="hl">
    <button id="btnHigh" class="btn btnH">HIGH↑</button>
    <button id="btnLow" class="btn btnL">LOW↓</button>
  </div>

  <div class="row"><label>残高</label><div id="bal">¥1,000,000</div></div>
</div>

<div class="pill" id="rateText">---</div>

<!-- Lightweight Charts v4 正式対応CDN -->
<script src="https://unpkg.com/lightweight-charts@4.0.0/dist/lightweight-charts.standalone.production.js"></script>

<script>
/* ====== チャート初期化 ====== */
const chart = LightweightCharts.createChart(document.getElementById('chart'), {
  layout:{background:{color:'#000'},textColor:'#fff'},
  grid:{vertLines:{visible:false},horzLines:{visible:false}}
});
const candleSeries = chart.addCandlestickSeries();

/* ====== データ生成 ====== */
let rate=150.000;
let candles=[];
for(let i=0;i<100;i++){
  const prev=rate;
  rate = +(prev*(1+(Math.random()-0.5)*0.005)).toFixed(3);
  candles.push({
    time: Date.now()/1000 + i*60,
    open:prev,high:Math.max(prev,rate)+0.01,
    low:Math.min(prev,rate)-0.01,close:rate
  });
}
candleSeries.setData(candles);

/* ====== UI & ロジック ====== */
let balance=1000000, payout=1.8, stake=1000;

document.getElementById('stake').onchange=e=>stake=+e.target.value||1000;
document.getElementById('payout').onchange=e=>payout=+e.target.value||1.8;

function update(){
  const prev=rate;
  rate = +(prev*(1+(Math.random()-0.5)*0.004)).toFixed(3);
  const last={time:Date.now()/1000,open:prev,high:Math.max(prev,rate)+0.01,low:Math.min(prev,rate)-0.01,close:rate};
  candles.push(last);
  chart.timeScale().fitContent();
  candleSeries.update(last);
  document.getElementById('rateText').textContent=rate;
}
setInterval(update,1000);
</script>

</body>
</html>
